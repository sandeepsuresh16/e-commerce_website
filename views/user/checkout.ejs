<!DOCTYPE html>
<html lang="en">


<!-- Mirrored from portotheme.com/html/wolmart/checkout.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Nov 2021 04:59:15 GMT -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">

    <title>Wolmart-eCart</title>

    <meta name="keywords" content="ecommerce" />
    <meta name="description" content="e-cart.">
    <meta name="sandeep" content="ecart">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/user/assets/images/icons/favicon.png">

    <style>
        #redeemButton {
            font-size: 1.8rem;
            border: gray;
            background-color: gray;
            color: #fff;
            padding: 5px;
            margin-top: 5px;
            box-shadow: 5px 5px 5px 2px grey;
            cursor: pointer;
        }
    </style>
    <!-- WebFont.js -->
    <script>
        WebFontConfig = {
            google: { families: ['Poppins:400,500,600,700'] }
        };
        (function (d) {
            var wf = d.createElement('script'), s = d.scripts[0];
            wf.src = 'assets/js/webfont.js';
            wf.async = true;
            s.parentNode.insertBefore(wf, s);
        })(document);
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="preload" href="/user/assets/vendor/fontawesome-free/webfonts/fa-regular-400.woff2" as="font"
        type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="/user/assets/vendor/fontawesome-free/webfonts/fa-solid-900.woff2" as="font"
        type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="/user/assets/vendor/fontawesome-free/webfonts/fa-brands-400.woff2" as="font"
        type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="/user/assets/fonts/wolmart87d5.woff?png09e" as="font" type="font/woff"
        crossorigin="anonymous">

    <!-- Vendor CSS -->
    <link rel="stylesheet" type="text/css" href="/user/assets/vendor/fontawesome-free/css/all.min.css">

    <!-- Plugin CSS -->
    <link rel="stylesheet" type="text/css" href="/user/assets/vendor/magnific-popup/magnific-popup.min.css">

    <!-- Default CSS -->
    <link rel="stylesheet" type="text/css" href="/user/assets/css/style.min.css">
</head>

<body>
    <div class="page-wrapper">

        <!-- Start of Header -->
        <header class="header header-border">
            <div class="header-top">
                <div class="container">


                </div>
            </div>
            <!-- End of Header Top -->

            <div class="header-middle">
                <div class="container">
                    <div class="header-left mr-md-4">
                        <a href="#" class="mobile-menu-toggle  w-icon-hamburger" aria-label="menu-toggle">
                        </a>
                        <a href="/" class="logo ml-lg-0">
                            <img src="/user/assets/images/logo.png" alt="logo" width="144" height="45" />
                        </a>
                        <form method="post" action="/search"
                            class="header-search hs-expanded hs-round d-none d-md-flex input-wrapper">
                            <div class="select-box">
                                <select id="category" name="category">
                                    <option value="">All Categories</option>
                                    <%for(var i=0; i<category.length;i++){%>
                                        <option value="<%=category[i].categoryName.toUpperCase()%>">
                                            <%=category[i].categoryName.toUpperCase()%>
                                        </option>
                                        <%}%>
                                </select>
                            </div>
                            <input type="text" class="form-control" name="search" id="search" placeholder="Search in..."
                                required />
                            <button class="btn btn-search" type="submit"><i class="w-icon-search"></i>
                            </button>
                        </form>
                    </div>
                    <div class="header-right ml-4">

                        <% if(logged){%>
                            <a class="wishlist label-down link d-xs-show" href="/account">
                                <i class="fas fa-user"></i>
                                <span class="wishlist-label d-lg-show">
                                    <%= data.name%>
                                </span>
                            </a>
                            <%}%>
                                <% if(!logged){%>
                                    <div class="mr-2">
                                        <h4><a href="/login">login</a></h4>
                                    </div>
                                    <div>
                                        <h4 class="me-2"><a href="/signup-otp-page">signup</a></h4>
                                    </div>
                                    <%}%>
                                        <% if(logged){%>

                                            <a class="wishlist label-down link d-xs-show" href="/user/wishlist">
                                                <i class="fas fa-heart"><sup
                                                    style="color: blue;font-size:2rem ;" id="wishlistCount">
                                                    <%=wishlistCount%>
                                                </sup></i>
                                                <span class="wishlist-label d-lg-show">Wishlist</span>
                                            </a>

                                            <a href="/cart" class="wishlist label-down link d-xs-show">
                                                <i class="fas fa-shopping-cart"><sup
                                                        style="color: blue;font-size:2rem ;" id="cartCount">
                                                        <%=cartCount%>
                                                    </sup></i>
                                                <span class="cart-label">Cart</span>
                                            </a>
                                            <a class="wishlist label-down link d-xs-show" href="/logout">
                                                <i class="fas fa-sign-out-alt"></i>
                                                <span class="wishlist-label d-lg-show">logout</span>
                                            </a>

                                            <%}%>
                    </div>
                </div>
            </div>
            <!-- End of Header Middle -->

            <div class="header-bottom sticky-content fix-top sticky-header">
                <div class="container">
                    <div class="inner-wrap">
                        <div class="header-left">
                            <div class="dropdown category-dropdown has-border" data-visible="true">
                                <a href="#" class="category-toggle" role="button" data-toggle="dropdown"
                                    aria-haspopup="true" aria-expanded="true" data-display="static"
                                    title="Browse Categories">
                                    <i class="w-icon-category"></i>
                                    <span>Browse Categories</span>
                                </a>

                                <div class="dropdown-box">
                                    <ul class="menu vertical-menu category-menu">
                                        <%for(var i=0; i<category.length;i++){%>
                                            <li>
                                                <a href="/display-category?categoryName=<%=category[i].categoryName%>">
                                                    <%=category[i].categoryName.toUpperCase()%>
                                                </a>
                                            </li>
                                            <%}%>
                                    </ul>
                                </div>
                            </div>
                            <nav class="main-nav">
                                <ul class="menu active-underline">
                                    <li>
                                        <a href="/">Home</a>
                                    </li>
                                    <li>
                                        <a href="/shop">Shop</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- End of Header -->

        <!-- Start of Main -->
        <main class="main checkout" id="myDiv" style="min-height: 90vh;">
            <!-- Start of Breadcrumb -->
            <nav class="breadcrumb-nav">
                <div class="container">
                    <ul class="breadcrumb shop-breadcrumb bb-no">
                        <li class="passed"><a href="/cart">Shopping Cart</a></li>
                        <li class="active"><a href="">Checkout</a></li>
                        <li><a href="order.html">Order Complete</a></li>
                    </ul>
                </div>
            </nav>
            <!-- End of Breadcrumb -->


            <!-- Start of PageContent -->
            <div class="page-content">
                <div class="container"> 
                    <form id="checkout-form">
                        <div class="row mb-9">
                            <div class="col-lg-7 pr-lg-4">
                                <h3 class="text-uppercase ls-10 pt-1 pb-3 mb-0">
                                    Delivery Address
                                </h3>
                                <h4 style="margin-top:1rem; margin-bottom: 1rem;"><a href="#addAddress">+ Add New Address</a></h4>
                                <div id="address-field" style="height: 30vh;overflow-y: auto;">
                                    <%if(address.length==0){%>
                                        <div class="pt-6">
                                            <a href="#addAddress"> <button type="button"
                                                    class="btn btn-dark  btn-rounded">
                                                    Add Delivery Address
                                                </button>
                                            </a>
                                        </div>
                                        <%}%>
                                            <%for(var i=0; i<address.length;i++){%>
                                                <table>
                                                    <tbody>
                                                        <tr>
                                                            <td><input type="radio" name="addressId"
                                                                    value="<%=address[i]._id%>" checked></td>
                                                            <td style="text-transform: uppercase">
                                                                <b>
                                                                    <%=address[i].details.name%>
                                                                </b><br>
                                                                <b>
                                                                    <%=address[i].details.address%>
                                                                </b><br>
                                                                <b>
                                                                    <%=address[i].details.phone%>
                                                                </b><br>
                                                                <b>
                                                                    <%=address[i].details.pin%>
                                                                </b><br>
                                                            </td>
                                                        </tr>
                                                        <hr>
                                                    </tbody>
                                                </table>
                                                <%}%>
                                </div>

                            </div>
                            <div class="col-lg-5 mb-4 sticky-sidebar-wrapper">
                                <div class="order-summary-wrapper sticky-sidebar">
                                    <h3 class="title text-uppercase ls-10">Your Order</h3>
                                    <div class="order-summary">
                                        <table class="order-table">
                                            <thead>
                                                <tr>
                                                    <th colspan="2">
                                                        <b>Product</b>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <%for(var i=0;i<cartItem.length;i++){%>
                                                    <tr class="bb-no">
                                                        <td class="product-name">
                                                            <%=cartItem[i].product.productName%><i
                                                                    class="fas fa-times"></i> <span
                                                                    class="product-quantity">
                                                                    <%=cartItem[i].quantity%>
                                                                </span>
                                                        </td>
                                                        <td class="product-total">
                                                            <%=cartItem[i].subTotal%>
                                                        </td>
                                                    </tr>
                                                    <%}%>
                                            </tbody>
                                            <tfoot>
                                                <tr class="order-total">
                                                    <td>Coupon Applied</td>
                                                    <td><p id="couponDiscount" style="color: green;">0</p></td>
                                                </tr>
                                                <tr class="order-total">
                                                    <th>
                                                        <b>Total</b>
                                                    </th>
                                                    <td>
                                                        <b id="total">
                                                            ₹ <%=total%>
                                                        </b>
                                                    </td>
                                                </tr>
                                            </tfoot>
                                        </table>

                                        <div class="payment-methods mb-3" id="payment_method">
                                            <h4 class="title font-weight-bold ls-25 pb-0">Payment Methods</h4>
                                            <div>
                                                <table>
                                                    <tbody>
                                                        <tr>
                                                            <td>
                                                                <input type="radio" name="payment-method" value="COD"
                                                                    checked><br>
                                                            </td>
                                                            <td style="font-size: 16px;">
                                                                <b>Cash on Delivery (COD)</b>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <input type="radio" name="payment-method"
                                                                    value="RASORPAY">
                                                            </td>
                                                            <td style="font-size: 16px;">
                                                                <b>Razorpay</b>
                                                            </td>
                                                        </tr>
                                                        <tr>
                                                            <td>
                                                                <input type="radio" name="payment-method"
                                                                    value="PAYPAL">
                                                            </td>
                                                            <td style="font-size: 16px;">
                                                                <b>Paypal</b>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <input type="text" name="userId" value="<%=data._id%>" hidden>
                                        <input type="number" name="cartTotal" value="<%=total%>" id="cartTotal" hidden>
                                        <span id="redeemButton" onclick="redeemWallet()">Redeem Wallet</span>
                                        <hr>
                                        <div class="form-group place-order pt-6" id="placeOrderButton">
                                            <%if(address.length!=0){%>
                                            <button type="submit" class="btn btn-dark btn-block btn-rounded">Place Order</button>
                                            <%}else{%>
                                            <button class="btn btn-dark btn-block btn-rounded" onclick="addressError()">Place Order</button>
                                            <%}%>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                        <div class="container">
                            <div class="row">
                        
                        <!-- <div class="col-lg-5 pr-lg-4 mb-1 justify-content-end"  style="float: right;">
                            <form class="coupon" id="coupon-form">
                                <h5 class="title coupon-title font-weight-bold text-uppercase" style="color: blue;">Coupon Discount</h5>
                                <input type="text" class="form-control mb-1" name="couponCode" placeholder="Enter coupon code here..." required />
                                <button class="btn btn-dark btn-outline btn-rounded">Apply Coupon</button>
                            </form>
                        </div> -->
                        <div class="col-lg-7 pr-lg-4 mb-4"  id="addAddress">
                            <div class="row gutter-sm">
                                <div class="col-xs-6">
                                    <h4 class="text-uppercase ls-10 pt-1 pb-3 mb-0">
                                        Add New Address
                                    </h4>
                                    <div class="form-group">
                                        <form id="new-address">
                                            <label>Name *</label>
                                            <input type="text" class="form-control form-control-md" name="name" id="name">
                                            <p style="color: red;" id="namewarn"></p>
                                            <label>Address *</label>
                                            <input type="text" placeholder="House number and street name"
                                                class="form-control form-control-md mb-2" name="address" id="address">
                                                <p style="color: red;" id="addresswarn"></p>
                                            <label>Phone *</label>
                                            <input type="text" class="form-control form-control-md" name="phone" id="phone">
                                            <p style="color: red;" id="mobilewarn"></p>
                                            <label>PIN *</label>
                                            <input type="text" class="form-control form-control-md" name="pin" id="pin">
                                            <p style="color: red;" id="pinwarn"></p>
                                            <input type="text" name="userId" value="<%=data._id%>" hidden>
                                            <div class="form-group place-order pt-6">
                                                <button type="submit" class="btn btn-dark btn-block btn-rounded">Add
                                                    Address</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-5 pr-lg-4 mb-4 justify-content-end">
                            <form class="coupon m-3 border" id="coupon-form">
                                <h5 class="title coupon-title font-weight-bold text-uppercase" style="color: blue;">Redeem Coupon</h5>
                                <input type="text" class="form-control mb-1" name="couponCode" placeholder="Enter coupon code here..." required />
                                <button class="btn btn-dark btn-outline btn-rounded">Apply Coupon</button>
                            </form>
                        </div>
                        </div>
                        </div>
                        
                    
                </div>
            </div>
            <!-- End of PageContent -->
        </main>
        <!-- End of Main -->

        <!-- Start of Footer -->
        <footer class="footer appear-animate" data-animation-options="{
            'name': 'fadeIn'
        }">
            <div class="footer-newsletter bg-primary">
                <div class="container">
                    <div class="row justify-content-center align-items-center">
                        <div class="icon-box-content text-center col-12">

                            <h5 style="color: #fff;">© Copyright . All Rights Reserved</h5>
                        </div>
                    </div>
                </div>
            </div>

        </footer>
        <!-- End of Footer -->
    </div>
    <!-- End of Page Wrapper -->

    <!-- Start of Sticky Footer -->
    <div class="sticky-footer sticky-content fix-bottom">
        <a href="/" class="sticky-link active">
            <i class="w-icon-home"></i>
            <p>Home</p>
        </a>
        <a href="/shop" class="sticky-link">
            <i class="w-icon-category"></i>
            <p>Shop</p>
        </a>
        <% if(logged){%>
        <a href="/account" class="sticky-link">
            <i class="w-icon-account"></i>
            <p>Account</p>
        </a>
        <a href="/cart" class="sticky-link">
            <i class="w-icon-cart"></i>
            <p>Cart</p>
        </a>
        <a href="/user/wishlist" class="sticky-link">
            <i class="w-icon-heart"></i>
            <p>Wishlist</p>
        </a>
        <%}%>
    </div>
    <!-- End of Sticky Footer -->

    <!-- Start of Scroll Top -->

    <!-- End of Scroll Top -->

    <!-- Start of Mobile Menu -->
    <div class="mobile-menu-wrapper">
        <div class="mobile-menu-overlay"></div>
        <!-- End of .mobile-menu-overlay -->

        <a href="#" class="mobile-menu-close"><i class="close-icon"></i></a>
        <!-- End of .mobile-menu-close -->

        <div class="mobile-menu-container scrollable">
            <form action="/product_search" method="post" class="input-wrapper">
                <input type="text" class="form-control" name="search" autocomplete="off" placeholder="Search"
                    required />
                <button class="btn btn-search" type="submit">
                    <i class="w-icon-search"></i>
                </button>
            </form>
            <!-- End of Search Form -->
            <div class="tab">
                <ul class="nav nav-tabs" role="tablist">
                    <li class="nav-item">
                        <a href="#main-menu" class="nav-link active">Main Menu</a>
                    </li>
                    <li class="nav-item">
                        <a href="#categories" class="nav-link">Categories</a>
                    </li>
                </ul>
            </div>
            <div class="tab-content">
                <div class="tab-pane active" id="main-menu">
                    <ul class="mobile-menu">
                        <li><a href="/">Home</a></li>
                        <li><a href="/shop">Shop</a></li>
                        <li><a href="/logout">logout</a></li>
                    </ul>
                </div>
                <div class="tab-pane" id="categories">
                    <ul class="mobile-menu">
                        <%for(var i=0; i<category.length;i++){%>
                            <li>
                                <a href="/display-category?categoryName=<%=category[i].categoryName%>">
                                    <%=category[i].categoryName.toUpperCase()%>
                                </a>
                            </li>
                        <%}%>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- End of Mobile Menu -->

    <!-- Plugin JS File -->
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        function addressError(){
            Swal.fire('Please Add Address')
        }

        function redeemWallet() {
            Swal.fire({
                title: 'Use Wallet?',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, use it!'
            }).then((result) => {
                if (result.isConfirmed) {
                    const total = $('#cartTotal').val()
                    $.ajax({
                        url:`/redeem-wallet?total=${total}`,
                        method:'get',
                        success:(response)=>{
                            if(response.status=='empty'){
                                Swal.fire('Your wallet is empty')
                            }else if(response.status=='min-value'){
                                Swal.fire('Cannot redeem wallet for this order')
                            }else if(response.status=='success'){
                                document.getElementById('cartTotal').value = response.newTotal
                                document.getElementById('total').innerHTML = response.newTotal
                                swal.fire('Wallet Redeemed Successfully')
                            }
                        }
                        
                    })
                }
            })
        }
        
        $('#checkout-form').submit((e) => {

            e.preventDefault()
            // alert($('#checkout-form').serialize())

            $.ajax({
                url: '/place-order-cart',
                method: 'post',
                data: $('#checkout-form').serialize(),
                success: (response) => {
                    
                    if (response.COD) {
                        Swal.fire({
                            "icon":"success",
                            "title":"Order Placed"
                        }).then(()=>{
                            location.href = '/order-complete'
                        })
                    }else if(response.RAZORPAY) {
                        
                        razorpayPayment(response)
                    }else if(response.paypal === true){
                        location.href = response.link
                    }else if(response.ERROR){
                        Swal.fire('Maximum limit exceeded for Razorpay Payment Method')
                    }
                }
            })

        })

        function razorpayPayment(order) {

            var options = {
                "key": "rzp_test_Oe4RXp4rqB0h89", // Enter the Key ID generated from the Dashboard
                "amount": order.amount * 100, // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
                "currency": "INR",
                "name": "wolmart",
                "description": "Test Transaction",
                "order_id": order.id, //This is a sample Order ID. Pass the `id` obtained in the previous step
                "handler": function (response) {
                    // alert(response.razorpay_payment_id);
                    // alert(response.razorpay_order_id);
                    // alert(response.razorpay_signature)

                    verifyPayment(response, order) // this function will contain ajax code for sending above data to server

                },
                "modal": {
                    "ondismiss": function () {
                        console.log('Checkout form closed')
                        // alert(order.receipt)
                        
                        $.ajax({
                            url:'/cancel-razorpay-payment',
                            method:'post',
                            data:{'orderId':order.receipt},
                            submit:(response)=>{
                                Swal.fire('cancelled')
                            }
                        })
                    }
                },
                "prefill": {
                    "name": "Gaurav Kumar",
                    "email": "gaurav.kumar@example.com",
                    "contact": "9999999999"
                },
                "notes": {
                    "address": "Razorpay Corporate Office"
                },
                "theme": {
                    "color": "#3399cc"
                }
            };
            var rzp1 = new Razorpay(options);
            rzp1.on('payment.failed', function (response) {
                console.log(response.error.code);
                console.log(response.error.description);
                console.log(response.error.source);
                console.log(response.error.step);
                console.log(response.error.reason);
                console.log(response.error.metadata.order_id);
                console.log(response.error.metadata.payment_id);
            });
            rzp1.open()
        }

        function verifyPayment(payment, order) {
            $.ajax({
                url: '/verify-payment',
                method: 'post',
                data: { payment, order },
                success: (response) => {
                    if (response.status) {
                        alert('PAYMENT SUCCESSFUl')
                        location.href = '/order-complete'
                    }
                    else {
                        alert('PAYMENT FAILED')
                    }
                }
            })
        }

        // $('#new-address').submit((e) => {
        //     e.preventDefault()
            
        //     $.ajax({
        //         url: '/add-new-address',
        //         method: 'post',
        //         data: $('#new-address').serialize(),
        //         success: (response) => {
                   
        //             $("#address-field").load(location.href + " #address-field");
        //             $("#placeOrderButton").load(location.href + " #placeOrderButton");
        //             $("#addAddress").load(location.href + " #addAddress");
                    
        //             window.location.hash = '#myDiv';
                    
        //         }
        //     })
        // })

        $('#new-address').submit((e) => {
            e.preventDefault()

            let nameError = true;
            function validateName() {
                let name = $('#name').val()
                if (name == "") {
                    $('#name').css('border-color', '#f30000')
                    
                    nameError = false
                    return false
                } else if (name.length < 3) {
                    $('#name').css('border-color', '#f30000')
                    $("#namewarn").text('minimum 3 characters')
                    nameError = false
                    return false
                }
            }

            let addressError = true;
            function validateAddress() {
                let address = $('#address').val()
                if (address == "") {
                    $('#address').css('border-color', '#f30000')
                    
                    addressError = false
                    return false
                } else if (address.length < 5) {
                    $('#address').css('border-color', '#f30000')
                    $("#addresswarn").text('Minimum 5 characters')
                    addressError = false
                    return false
                }
            }

            let mobileError = true
            function validateMobile() {

                let regnum = new RegExp("^[0-9 ]+$");

                let mobileValue = $('#phone').val();

                if (mobileValue.length == '') {

                    $('#phone').css('border-color', '#c70d0d')
                    

                    mobileError = false;
                    return false;
                } else if (!regnum.test(mobileValue)) {

                    $('#phone').css('border-color', '#c70d0d')
                    $("#mobilewarn").text('Enter Numbers Only')

                    mobileError = false;
                } else if (mobileValue.length != 10) {

                    $('#phone').css('border-color', '#c70d0d')
                    $("#mobilewarn").text('Mobile number must Contain 10 Digit')

                    mobileError = false;
                }

            }

            let pinError = true
            function validatePin() {

                let regnum = new RegExp("^[0-9 ]+$");

                let pinValue = $('#pin').val();

                if (pinValue.length == '') {

                    $('#pin').css('border-color', '#c70d0d')
                    pinError = false;
                    return false;
                } else if (!regnum.test(pinValue)) {

                    $('#pin').css('border-color', '#c70d0d')
                    $("#pinwarn").text('Enter Numbers Only')

                    pinError = false;
                } else if (pinValue.length != 6) {

                    $('#pin').css('border-color', '#c70d0d')
                    $("#pinwarn").text('Pincode is 6 digits')

                    pinError = false;
                }

            }

            validateAddress()
            validateMobile()
            validateName()
            validatePin()

            if (nameError === true && addressError === true && pinError === true && mobileError === true) {
                $.ajax({
                    url: '/add-new-address',
                    method: 'post',
                    data: $('#new-address').serialize(),
                    success: (response) => {

                        $("#address-field").load(location.href + " #address-field");
                        $("#placeOrderButton").load(location.href + " #placeOrderButton");
                        $("#addAddress").load(location.href + " #addAddress");
                        window.location.hash = '#myDiv';

                    }
                })
            }


        })

        $('#coupon-form').submit((e)=>{
            e.preventDefault()
            const total = document.getElementById('cartTotal').value
            const code = $('#coupon-form').serialize()
            $.ajax({
                url:'/apply-coupon',
                method:'post',
                data:{total,code},
                success:(response)=>{
                    if(response.status=='min-amount'){
                        Swal.fire("Can't apply coupon to current order, please purchase more")
                    }else if(response.status=='used'){
                        Swal.fire('This Coupon already used')
                    }else if(response.status=='not-found'){
                        Swal.fire('Wrong Coupon Code')
                    }else{
                        document.getElementById('cartTotal').value = response.newTotal
                        document.getElementById('total').innerHTML=response.newTotal
                        document.getElementById('couponDiscount').innerHTML=-response.discount
                        Swal.fire('Coupon applied successfully')
                    }
                }
            })
        })
    </script>

    <script src="/user/assets/vendor/jquery/jquery.min.js"></script>
    <script src="/user/assets/vendor/sticky/sticky.js"></script>
    <script src="/user/assets/vendor/magnific-popup/jquery.magnific-popup.min.js"></script>
    <script src="/user/assets/js/main.min.js"></script>
</body>


<!-- Mirrored from portotheme.com/html/wolmart/checkout.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 05 Nov 2021 04:59:17 GMT -->

</html>